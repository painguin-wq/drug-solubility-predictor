
# ML-прогнозирование растворимости лекарств на основе BigSolDB

Этот проект использует машинное обучение для прогнозирования растворимости лекарственных соединений в различных растворителях при разных температурах. Основой является датасет BigSolDBv2.0, содержащий экспериментальные данные о растворимости тысяч соединений.

## Цель проекта

Разработать и обучить модель машинного обучения для предсказания водной растворимости (logS) органических соединений на основе их молекулярной структуры (SMILES) и условий окружающей среды (температура, растворитель). Также реализована функция оптимизации условий для достижения максимальной растворимости.

## Ключевые возможности

*   **Сравнение моделей**: Автоматически обучает и оценивает пул регрессионных моделей (включая RandomForest, XGBoost, LightGBM, Lasso и др.).
*   **Выбор лучшей модели**: Сравнивает модели по метрикам MAE и R² и автоматически сохраняет только ту, которая показала наилучший результат.
*   **Предсказание оптимальных условий**: Использует лучшую обученную модель для поиска оптимальных условий (растворитель, температура) для заданной молекулы.
*   **Воспроизводимость**: Использование `poetry` гарантирует, что проект будет работать с одинаковыми версиями библиотек на любой машине.

## Технологический стек

*   **Python 3.10**
*   **Poetry** для управления зависимостями
*   **Pandas** для обработки и анализа данных
*   **RDKit** для хемоинформатики и генерации молекулярных дескрипторов
*   **Scikit-learn**, **XGBoost**, **LightGBM** для реализации моделей машинного обучения
*   **Joblib** для сохранения и загрузки обученных моделей

## Установка

### Требования
*   Git
*   Python 3.9+
*   Poetry

### Пошаговая инструкция

1.  **Клонируйте репозиторий:**
    ```bash
    git clone https://github.com/painguin-wq/drug-solubility-predictor.git
    cd drug-solubility-predictor
    ```

2.  **Установите зависимости:**
    Poetry автоматически создаст виртуальное окружение (`.venv`) и установит все необходимые библиотеки из файла `pyproject.toml`.
    ```bash
    poetry install
    ```

3.  **Подготовка данных:**
    Исходные данные не хранятся в этом репозитории. Был использован датасет: Krasnov, L., Malikov, D., Kiseleva, M. et al. BigSolDB 2.0, dataset of solubility values for organic compounds in different solvents at various temperatures. Sci Data 12, 1236 (2025). https://doi.org/10.1038/s41597-025-05559-8
    1.  Скачайте датасет [BigSolDBv2.0.csv](https://github.com/levakrasnovs/BigSolDBv2.0/blob/main/BigSolDBv2.0.csv).
    2.  Создайте директорию `data/raw/` в корне проекта.
    3.  Поместите скачанный файл `BigSolDBv2.0.csv` в эту директорию.

    После этого шага структура папки `data` должна быть следующей:
    ```
    data/
    └── raw/
        └── BigSolDBv2.0.csv
    ```

## Использование

Проект разделен на два основных этапа, которые запускаются простыми командами из корневой директории проекта.

### Этап 1: Обучение и сравнение моделей

Эта команда запускает полный пайплайн: обработку данных, генерацию признаков, обучение всех моделей из пула, их сравнение и сохранение лучшей модели в файл `models/best_model.pkl`.

```bash
poetry run train
```
В конце выполнения в консоль будет выведена сводная таблица с результатами (MAE, R², время обучения) для всех протестированных моделей.

### Этап 2: Получение предсказаний

После того как лучшая модель обучена и сохранена, вы можете использовать ее для предсказания. Скрипт автоматически загрузит `models/best_model.pkl` и выведет предсказание для тестовой молекулы, указанной в файле `src/predict.py`.

```bash
poetry run predict
```
Вы можете изменить SMILES-строку внутри `src/predict.py`, чтобы протестировать другие соединения.