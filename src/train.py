# src/train.py

from src.data.process import process_solubility_data
from src.features.smiles_featurizer import featurize_compounds
# --- –ò–ó–ú–ï–ù–ï–ù–ò–ï 1: –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ù–û–í–£–Æ —Ñ—É–Ω–∫—Ü–∏—é ---
from src.models.solubility_model import train_and_evaluate_models

def main():
    """
    –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –æ–±—É—á–µ–Ω–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π.
    """
    print("üöÄ –≠—Ç–∞–ø 1: –û–±—É—á–µ–Ω–∏–µ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π...")

    # 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
    print("\n--- –®–∞–≥ 1: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ ---")
    df = process_solubility_data()

    # 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ–ª–µ–∫—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    print("\n--- –®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ–ª–µ–∫—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ---")
    df = featurize_compounds(df)
    df.to_csv("data/processed/solubility_with_features.csv", index=False)
    print("üíæ –î–∞–Ω–Ω—ã–µ —Å —Ñ–∏—á–∞–º–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.")

    # 3. –û–±—É—á–µ–Ω–∏–µ, –æ—Ü–µ–Ω–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
    print("\n--- –®–∞–≥ 3: –û–±—É—á–µ–Ω–∏–µ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π ---")
    # --- –ò–ó–ú–ï–ù–ï–ù–ò–ï 2: –í—ã–∑—ã–≤–∞–µ–º –ù–û–í–£–Æ —Ñ—É–Ω–∫—Ü–∏—é ---
    train_and_evaluate_models(df)

    print("\n‚úÖ –≠—Ç–∞–ø –æ–±—É—á–µ–Ω–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à—ë–Ω. –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.")


if __name__ == "__main__":
    main()